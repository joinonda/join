<section class="contacts-section" role="region" aria-labelledby="contacts-heading">
  <div class="contacts-container">
    <div class="add-contact-btn-container">
      <button class="add-contact-btn" type="button" (click)="onAdd()">
        <span>Add new Contact</span>
        <img
          src="imgs/add-new-contact-person-plus.png"
          width="32"
          height="32"
          alt=""
          aria-hidden="true"
        />
      </button>
    </div>
    <div class="contact-list" role="region" aria-label="Contact list">
      <div class="contacts-scroll" role="list">
        @for (letter of alphabet; track letter) { @if (groupedContacts[letter]?.length) {
        <div class="contact-group">
          <div class="letter-header-container">
            <div class="letter-header-letter-box">
              <div class="letter-header-letter" role="heading" aria-level="3">
                {{ letter }}
              </div>
              <div class="letter-header-right"></div>
            </div>
            <div class="letter-header-divider"></div>
          </div>
          
          @for (contact of groupedContacts[letter]; track $index) {
          <div class="contact-item"
            [class.selected]="isSelected(contact)"
            (click)="selectContact(contact)"
            role="button"
            tabindex="0"
            (keydown.enter)="selectContact(contact)"
            (keydown.space)="selectContact(contact)"
          >
            <div
              class="contact-avatar"
              [style.background-color]="getContactColor(contact)"
              role="img"
              [attr.aria-label]="
                getInitials(contact.firstName, contact.lastName) + ' contact avatar'
              "
            >
              {{ getInitials(contact.firstName, contact.lastName) }}
            </div>
            <div class="contact-info">
              <div class="contact-name">{{ contact.firstName }} {{ contact.lastName }}</div>
              <div class="contact-email">{{ contact.email }}</div>
            </div>
          </div>
          }
        </div>
        } }
      </div>
    </div>

    <button
      class="mobile-add-contact-fab"
      type="button"
      (click)="onAdd()"
      aria-label="Add new Contact"
    >
      <img src="imgs/add-new-contact-person-plus.png" alt="" aria-hidden="true" />
    </button>
  </div>
  <div class="contacts-header">
    <div class="header-content">
      <h2 id="contacts-heading">Contacts</h2>
      <div class="header-separator"></div>
      <p>Better with a team</p>
    </div>

    @if (selectedContact) {
    <div class="detail-container" role="region" aria-label="Selected contact details">
      <app-contact-detail
        [contact]="selectedContact"
        [contactColor]="getContactColor(selectedContact)"
        [contactKey]="selectedContact.id"
        (edit)="onEdit()"
        (delete)="onDelete()"
      ></app-contact-detail>
    </div>
    }
  </div>

  @if (isEditOpen && editingContact) {
  <app-contact-form-dialog
    mode="edit"
    [contact]="editingContact"
    [contactColor]="getContactColor(editingContact)"
    (save)="saveEdit($event)"
    (delete)="onDelete()"
    (close)="closeEdit()">
</app-contact-form-dialog>
  } 
  
  @if (isAddOpen) {
  <app-contact-form-dialog
    mode="add"
    (save)="saveAdd($event)"
    (close)="closeAdd()"
  ></app-contact-form-dialog>
  } 
  
  @if (isDetailDialogOpen && detailDialogContact) {
  <app-contact-detail-dialog
    [contact]="detailDialogContact"[contactColor]="getContactColor(detailDialogContact) "(edit)="onDetailEdit()"(delete)="onDetailDelete()"(close)="closeDetailDialog()"
  ></app-contact-detail-dialog>
  }

  <app-toast></app-toast>
</section>
