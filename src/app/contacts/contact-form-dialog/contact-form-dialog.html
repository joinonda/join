<div class="overlay" (click)="onBackdropClick($event)">
  <div class="dialog-container">
    <div class="dialog-left">
      <img src="imgs/logo-white.png" alt="Join Logo" class="logo" width="55.6" height="66.48" />
      <div class="dialog-header">
        <h2 class="dialog-title">{{ title }}</h2>
      </div>
      @if (subtitle) {
      <p class="dialog-subtitle">{{ subtitle }}</p>
      }
      <div class="title-underline"></div>
    </div>

    <div class="dialog-right">
      <button class="close-btn" (click)="onClose()" type="button">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path
            d="M18 6L6 18M6 6l12 12"
            stroke="#2A3647"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>

      <div class="right-content">
        <div class="avatar-container">
          @if (mode === 'edit' && contact) {
          <div class="avatar" [style.background-color]="contactColor">
            {{ initials }}
          </div>
          } @else {
          <div class="avatar avatar-placeholder">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
              <path
                d="M32 32C39.732 32 46 25.732 46 18C46 10.268 39.732 4 32 4C24.268 4 18 10.268 18 18C18 25.732 24.268 32 32 32Z"
                fill="white"
              />
              <path
                d="M32 38C19.8497 38 10 47.8497 10 60H54C54 47.8497 44.1503 38 32 38Z"
                fill="white"
              />
            </svg>
          </div>
          }
        </div>

        <form class="contact-form" (ngSubmit)="onSave()">
          <div class="input-wrapper">
            <input
              type="text"
              [(ngModel)]="formData.name"
              name="name"
              placeholder="Name"
              required
              class="form-input"
              [class.edit-mode]="mode === 'edit'"
              [class.invalid]="nameError && (nameInput.dirty || nameInput.touched)"
              #nameInput="ngModel"
              (input)="validateName()"
            />
            <img src="imgs/input-name-person.png" alt="Name icon" class="input-icon" />
            @if (nameError && (nameInput.dirty || nameInput.touched)) {
            <span class="error-message">{{ nameError }}</span>
            }
          </div>

          <div class="input-wrapper">
            <input
              type="email"
              [(ngModel)]="formData.email"
              name="email"
              placeholder="Email"
              required
              class="form-input"
              [class.invalid]="emailError && (emailInput.dirty || emailInput.touched)"
              #emailInput="ngModel"
              (input)="validateEmail()"
            />
            <img src="imgs/input-mail-letter.png" alt="Email icon" class="input-icon" />
            @if (emailError && (emailInput.dirty || emailInput.touched)) {
            <span class="error-message">{{ emailError }}</span>
            }
          </div>

          <div class="input-wrapper">
            <input
              type="tel"
              [(ngModel)]="formData.phone"
              name="phone"
              placeholder="Phone"
              required
              class="form-input"
              [class.invalid]="phoneError && (phoneInput.dirty || phoneInput.touched)"
              #phoneInput="ngModel"
              (input)="validatePhone()"
            />
            <img src="imgs/input-call-phone.png" alt="Phone icon" class="input-icon" />
            @if (phoneError && (phoneInput.dirty || phoneInput.touched)) {
            <span class="error-message">{{ phoneError }}</span>
            }
          </div>

          <div class="button-group">
            @if (mode === 'edit') {
            <button type="button" class="btn-secondary" (click)="onDelete()">Delete</button>
            } @else {
            <button type="button" class="btn-secondary" (click)="onClose()">
              Cancel
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path
                  d="M18 6L6 18M6 6l12 12"
                  stroke="#2A3647"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            }
            <button type="submit" class="btn-primary">
              {{ saveButtonText }}
              @if (mode === 'add') {
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path
                  d="M20 6L9 17l-5-5"
                  stroke="#FFFFFF"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              }
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
