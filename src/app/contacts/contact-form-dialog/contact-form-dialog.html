<div class="overlay" (click)="onBackdropClick($event)">
  <div class="dialog-container">
    <div class="dialog-left">
      <img src="imgs/logo-white.png" alt="Join Logo" class="logo" width="55.6" height="66.48" />
      <div class="dialog-header">
        <h2 class="dialog-title">{{ title }}</h2>
      </div>
      @if (subtitle) {
      <p class="dialog-subtitle">{{ subtitle }}</p>
      }
      <div class="title-underline"></div>
    </div>

    <div class="dialog-right">
      <button class="close-btn" (click)="onClose()" type="button">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path
            d="M18 6L6 18M6 6l12 12"
            stroke="#2A3647"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>

      <div class="right-content">
        <div class="avatar-container">
          @if (mode === 'edit' && contact) {
          <div class="avatar" [style.background-color]="contactColor">
            {{ initials }}
          </div>
          } @else {
          <div class="avatar avatar-placeholder">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
              <path
                d="M32 32C39.732 32 46 25.732 46 18C46 10.268 39.732 4 32 4C24.268 4 18 10.268 18 18C18 25.732 24.268 32 32 32Z"
                fill="white"
              />
              <path
                d="M32 38C19.8497 38 10 47.8497 10 60H54C54 47.8497 44.1503 38 32 38Z"
                fill="white"
              />
            </svg>
          </div>
          }
        </div>

        <form class="contact-form" (ngSubmit)="onSave()">
          <div class="input-wrapper">
            <input
              type="text"
              [(ngModel)]="formData.name"
              name="name"
              placeholder="Name"
              required
              class="form-input"
              [class.edit-mode]="mode === 'edit'"
              [class.invalid]="nameError && (nameInput.dirty || nameInput.touched)"
              #nameInput="ngModel"
              (input)="validateName()"
            />
            <svg class="input-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path
                d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21"
                stroke="#A8A8A8"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <circle
                cx="12"
                cy="7"
                r="4"
                stroke="#A8A8A8"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            <span class="error-message" *ngIf="nameError && (nameInput.dirty || nameInput.touched)">
              {{ nameError }}
            </span>
          </div>

          <div class="input-wrapper">
            <input
              type="email"
              [(ngModel)]="formData.email"
              name="email"
              placeholder="Email"
              required
              class="form-input"
              [class.invalid]="emailError && (emailInput.dirty || emailInput.touched)"
              #emailInput="ngModel"
              (input)="validateEmail()"
            />
            <svg class="input-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path
                d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z"
                stroke="#A8A8A8"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <polyline
                points="22,6 12,13 2,6"
                stroke="#A8A8A8"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            <span
              class="error-message"
              *ngIf="emailError && (emailInput.dirty || emailInput.touched)"
            >
              {{ emailError }}
            </span>
          </div>

          <div class="input-wrapper">
            <input
              type="tel"
              [(ngModel)]="formData.phone"
              name="phone"
              placeholder="Phone"
              required
              class="form-input"
              [class.invalid]="phoneError && (phoneInput.dirty || phoneInput.touched)"
              #phoneInput="ngModel"
              (input)="validatePhone()"
            />
            <svg class="input-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path
                d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"
                stroke="#A8A8A8"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            <span
              class="error-message"
              *ngIf="phoneError && (phoneInput.dirty || phoneInput.touched)"
            >
              {{ phoneError }}
            </span>
          </div>

          <div class="button-group">
            @if (mode === 'edit') {
            <button type="button" class="btn-secondary" (click)="onDelete()">Delete</button>
            } @else {
            <button type="button" class="btn-secondary" (click)="onClose()">
              Cancel
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path
                  d="M18 6L6 18M6 6l12 12"
                  stroke="#2A3647"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            }
            <button type="submit" class="btn-primary">
              {{ saveButtonText }}
              @if (mode === 'add') {
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path
                  d="M20 6L9 17l-5-5"
                  stroke="#FFFFFF"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              }
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
